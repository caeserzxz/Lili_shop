{extend name="layouts/base" /}
{block name="main" }
<script type="text/javascript" src="__STATIC__/js/highcharts/highcharts.js"></script>
<script type="text/javascript" src="__STATIC__/js/highcharts/highcharts_more.js"></script>
<section class="scrollable wrapper  ">

        <section class="panel panel-default ">
            <header class="panel-heading font-bold">
                <form id="forms" onsubmit="return evalstat();" >
                <div class="form-group">
                    <a class="btn btn-default " data-toggle="reportrange" data-change="submit">
                        <i class="fa fa-calendar fa-lg"></i>
                        <small>下单时间</small>
                        <span></span> <b class="caret"></b>
                        <input type="hidden" value="{$start_date} - {$end_date}" id="reportrange" name="reportrange" />
                    </a> <a href="javascript:;" data-toggle="popover" data-html="true" data-placement="bottom"
                            data-trigger="hover"
                            data-content="<p style='color:#999'><strong style='color:#333'>下单数：</strong>每日提交的订单数；</p><p style='color:#999'><strong style='color:#333'>待签收数：</strong>每日待签收订单数；</p><p style='color:#999'><strong style='color:#333'>发货数：</strong>每天发货的订单数。</p>"
                            data-original-title="" title=""><i class="fa fa-question-circle fa-lg m-l-xs"></i></a>
                </div>
                </form>
            </header>
            <div class="panel-body">
                <!--   style="height: 210px"  -->
                <div id="container"></div>
            </div>
            <footer class="panel-footer bg-white no-padder">
                <div class="row text-center no-gutter">

                    <div class="col-xs-3 b-r b-light">
                        <span class="h4 font-bold m-t block" id="total_add_num">0</span>
                        <small class="text-muted m-b block">下单总数</small>
                    </div>
                    <div class="col-xs-3 b-r b-light">
                        <span class="h4 font-bold m-t block" id="total_pay_num">0</span>
                        <small class="text-muted m-b block">成交总数</small>
                    </div>
                    <div class="col-xs-3 b-r b-light">
                        <span class="h4 font-bold m-t block" id="total_shpping_num">0</span>
                        <small class="text-muted m-b block">发货总数</small>
                    </div>
                    <div class="col-xs-3">
                        <span class="h4 font-bold m-t block" id="total_sign_num">0</span>
                        <small class="text-muted m-b block">签收总数</small>
                    </div>
                </div>
            </footer>
        </section>


</section>
<script type="text/javascript">
    var the_first = true;
    function evalstat() {
        var arr = $('#forms').toJson()
        jq_ajax('{:url("evalStat")}',arr,function(res){
            if (the_first == true){
                the_first = false;
                $('#t_day_order_num').html(res.stats.today.all_add_num);
                $('#y_day_order_num').html(res.stats.yesterday.all_add_num);
                $('#t_day_pay_num').html(res.stats.today.order_pay_num);
                $('#y_day_pay_num').html(res.stats.yesterday.order_pay_num);
                $('#t_day_wait_shipping_num').html(res.stats.today.wait_shipping_num);
                $('#y_day_wait_shipping_num').html(res.stats.yesterday.wait_shipping_num);
                $('#t_day_sign_num').html(res.stats.today.sign_num);
                $('#y_day_sign_num').html(res.stats.yesterday.sign_num);
            }
           

            $('#total_add_num').html(res.stats.total_add_num);
            $('#total_pay_num').html(res.stats.total_pay_num);
            $('#total_shpping_num').html(res.stats.total_shpping_num);
            $('#total_sign_num').html(res.stats.total_sign_num);
            $('#container').highcharts({
                    chart: {type: 'spline'},
                    title: {text: ''},
                    subtitle: {text: ''},
                    xAxis: { categories: res.riqi},
                    yAxis: {
                    title: {text: ''},
                    min: 0
                },
                tooltip: {
                    formatter: function () {
                        return '<b>时间:' + this.x + '</b><br>' + this.series.name + ': ' + this.y + '';
                    }
                },
                series: [{
                    name: '下单数 <span style="color:gray" >(点击隐藏)</span>',
                    data: res.stats.all_add_num
                },{
                    name: '成交数 <span style="color:gray" >(点击隐藏)</span>',
                    data: res.stats.order_pay_num
                },{
                    name: '发货数 <span style="color:gray" >(点击隐藏)</span>',
                            data:res.stats.shipping_order_num
                }, {
                    name: '签收数 <span style="color:gray" >(点击隐藏)</span>',
                    data:res.stats.sign_order_num
                }]
            });

        })
        return false;
    }
    $(function(){
        evalstat();
    })
</script>
{/block}
