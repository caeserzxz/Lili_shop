{extend name="layouts@base" /}
{block name="head"}
<style>
    .myCode .block{
        padding:0.23rem;
    }
    .myCode .imgBoxZ {
        text-align: center;
       line-height: 5rem;
        box-shadow: 0.006667rem 0.006667rem 0.1rem 0 rgba(0, 0, 0, 0.05);
        background-color: #fff;
        position: relative;
        height: 7.2rem;
    }
    .myCode .page-ft {
        width: 100%;
        z-index: 9;
        display: -webkit-box;
        display: -webkit-flex;
        display: flex;
    }
    .myCode .page-ft div {
        -webkit-box-flex: 1;
        -webkit-flex: 1;
        flex: 1;
        height: 0.6rem;
        display: -webkit-box;
        display: -webkit-flex;
        display: flex;
        -webkit-box-align: center;
        -webkit-align-items: center;
        align-items: center;
        -webkit-box-pack: center;
        -webkit-justify-content: center;
        justify-content: center;
    }
    .myCode .page-ft div img {
        width: 0.186667rem;
        height: 0.186667rem;
        margin-right: 0.04rem;
    }
    .save-btn {
        position: fixed;
        left: 0.2rem;
        right: 0.2rem;
        bottom: 0.133333rem;
        height: 0.533333rem;
        text-align: center;
        line-height: 0.533333rem;
        font-size: 0.186667rem;
        color: #ffffff;
        background-color: #fd0035;
        border-radius: 0.266667rem;
    }
</style>
<script>
var choose_img = "{$default_img}";
</script>
{/block}
{block name='pageType'}myCode{/block}
{block name="main" }
<div class="page-bd ">
    <!-- 页面内容-->
        <div class="tabBox" >
          <div class="block " >
              <div class="imgBox ">
                  <img id="qrcode" src="" width="100%">
                  <div id="hold" style="text-align: center; line-height: 30px;display: none;">长按图片下载</div>
                  <div class="text_c fs28 color_r save-btn" style="display: none;">保存</div>
              </div>
          </div>
        </div>

    </div>
    <div class="page-ft hide">
      <div class="BGcolor_3 showbk"><img src="__STATIC__/mobile/default/images/myCode01.png" alt=""><span class="fs28 fw_b color_w">更换背景</span></div>
    </div>

</div>
{/block}

{block name="footer"}
<script type="text/javascript">
    var num = 0;
    var type = "{$type}";
    var appType = "{$appType}";
    function getCodeImg(){
        num++;
        var arr = new Object();
        arr.num = num;
        arr.type = type;
        jq_ajax('{:_url("/member/api.users/getShareImg")}',arr,function (res) {
            $('#qrcode').attr('src','data:image/jpg;base64,'+res.data.img);
        });
    }
    getCodeImg();
    $('.showbk').click(function () {
        getCodeImg()
    })
    $(function(){
        if(appType=='Android'){
            $('.save-btn').show();
        }else if(appType=='IOS'){
            $('.save-btn').show();
        }else{
            $('#hold').show();
        }
        $('.save-btn').on('click',function(){
            var share_img = $('#qrcode').attr('src');
            console.log(share_img);
            if(appType=='Android'){
                window.auc.downloadPicturetToBase64(share_img);
            }else if(appType=='IOS'){
                window.app.SavePhoto(share_img);
            }
        })
    })
</script>

{/block}